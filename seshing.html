<style>
    @font-face{
    font-family:'gd-title';
    src:url('/pusab.otf');
}
h1 {
    color: white;
    -webkit-text-stroke: 0.5px black;
    font-family:'gd-title';
    margin:0;
    text-align: center;
    font-size: 40px;
    text-shadow: 3px 3px #00000044;
}

.menu.closed {
    bottom: 100vh;
}
body {
  overflow:hidden;
  background-size: cover;
  background-attachment: fixed;
  background-image: url("gdbg.jpg");
  margin: 0;
  align-content: center;
}
.menu{
  transition-duration: 1s;
  transition-timing-function: cubic-bezier(0.5, -0.5, 0.2, 1.4);
  bottom: 0;
  position: relative;
  background:#995533;
  width: 70%;
  border: 3px solid black;
  outline: 2px solid white;
  border-radius: 13px;
  padding: 20px;
  margin: auto calc(15% - 20px);
  box-shadow: 0 3px inset #ffaa55, 0 -3px inset #553311;
  text-align: center;
  z-index:10;
}
    p {
    color: white;
    font-family: 'helvetica', sans-serif;
    font-size: 14px;
    text-align: center;
}

input[type="text"] {
    width: 70%;
    margin: 10px 15%;
    padding: 10px 20px;
    border-radius: 10px;
    background: #5C331F;
    border: 0;
    color: white;
    text-align: CENTER;
    font-family: 'helvetica', sans-serif;
    font-size: 14px;
}

input[type="text"]::placeholder {
    color: #ffffffaa;
    font-family: 'helvetica', sans-serif;
}

button {
    border-radius: 10px;
    padding: 6px;
    font-family: 'gd-title';
    min-width: 150px;
    color: white;
    font-size: 25px;
    -webkit-text-stroke: 0.8px black;
    background: #7ADE2D;
    text-shadow: 3px 3px #00000033;
    border: 2px solid black;
    outline: 2px solid white;
    box-shadow: 2px 2px inset #C6F249, -2px -2px inset #49851B;
    margin: 10px;
}

input[type="text"]:focus {
    outline: 0;
    border: 0;
}
button:active{
    transform:scale(1.1);
    animation:0.2s bounceButton linear;
}
@keyframes bounceButton {
  0% {
      transform: scale(1);
  }
  50% {
      transform: scale(1.12);
  }
  75% {
      transform: scale(1.06);
  }
  100% {
      transform: scale(1.1);
  }
}
.menu.shake {
    animation: shake 0.3s linear;
}
@keyframes shake{
    0%{
        left:0;
    }20%{
        left:30px;
    }50%{
        left:-20px;
    }70%{
        left:10px;
    }90%{
        left:-5px;
    }100%{
        left:0;
    }
}
.floor{
    opacity:0;
    transition-duration: 1s;
    transition-delay:1s;
    width: 100vw;
    height: 250px;
    position: absolute;
    bottom: 0;
    z-index: 2;
    background: url(floor.png);
    background-size: 300px;
    background-position-x: 0;
    border-top: 2px solid transparent;
    border-image: linear-gradient(90deg, #2269d7, white, #2269d7) 1;
    box-shadow: 0 -10px 100px 0px inset #000000aa;
}
.floor.shown,.gameplay.shown{
    opacity:1 !important;
}
.player{
    width:55px;
    height:50px;
    z-index:9;
    background-image:url(kwalla.png);
    background-size:55px 50px;
}
.gameplay{
    z-index:1;
    opacity:0;
    transition-duration: 1s;
    transition-delay:1s;
    width: 100vw;
    height: 1000px;
    position: absolute;
    bottom:250px;
    left:0;
}
.wall{
    position:absolute;
    background-image:url(block.png);
    background-size:50px 50px;
    bottom:0;
}
.rattledash{
    position:absolute;
    background-image:url(rattledash.png);
    background-size:60px 60px;
    bottom:0;
}
.bomb{
    position:absolute;
    background-image:url(bomb.png);
    background-size:30px 30px;
    bottom:0;
}
.player .bomb {
    position: relative;
    right: 15px !important;
    top: 10px;
}
.indicator{
    position:absolute;
    background:transparent;
    border-radius:100%;
    bottom:100px;
}
.indicator.on{
    background:#ffffff77;
}
</style>
<div class="menu closed" id="passMenu">
  <h1>Are you a colon fan?</h1>
  <p>Only true colon fans can get a good sesh. Prove you are a true fan:</p>
  <input type="text" placeholder="enter GD Colon's secret password" id="pass">
  <button id="submit">Submit</button>
</div>
<div class="floor"></div>
<div class="gameplay" style="left:0px;">
    <div class="wall" style="height:250px;width:50px;left:-1000px;"></div>
    <div class="wall" style="height:250px;width:50px;right:-1000px;"></div>
    <div class="rattledash" style="height:60px;width:60px;right:-955px;"></div>
    <div class="bomb" style="height:30px;width:30px;right:-400px;"></div>
    <div class="indicator" style="height:20px;width:20px;right:-800px;"></div>
</div>
<script>
    const passMenu = document.getElementById('passMenu');
    window.onload=() => {
        passMenu.classList.remove('closed');
    };
    const pass = document.getElementById('pass');
    const submit = document.getElementById('submit');
    const floor = document.querySelector('.floor');
    const word ='#GDCOLONHASSTRATS#';
    const gameplay = document.querySelector('.gameplay');
    const block = 50;
    let player;
    submit.addEventListener('mouseup', () => {
        if (pass.value === word) {
            passMenu.classList.add('closed');   
            floor.classList.add('shown');
            gameplay.classList.add('shown');
            setTimeout(() => {
                passMenu.remove();
                floor.style.transitionDuration = '0s';
                floor.style.transitionDelay = '0s';
                gameplay.style.transitionDuration = '0s';
                gameplay.style.transitionDelay = '0s';

                player = document.createElement('div');
                player.classList.add('player');
                player.style.position = 'absolute';
                player.style.left = 'calc(50% - 27px)';
                player.style.bottom = 'calc(50% - 25px)';
                gameLoop();
                document.body.appendChild(player);
            }, 2000);
        }else{
            pass.value = '';
            passMenu.classList.add('shake');
            setTimeout(() => {
                passMenu.classList.remove('shake');
            }, 500);
        }
    });
    let playerX = (window.innerWidth / 2) - 27;
    let playerY = (window.innerHeight / 2) - 25;
    let playerDx = 0;
    let playerDy = 0;
    let playerSpeed = 5;
    let isJumping = false;
    let keys = {};
    let rotate = 0;
    let playerAngle = 0;
    window.addEventListener('keydown', (e) => {
        keys[e.key] = true;
    });
    window.addEventListener('keyup', (e) => {
        keys[e.key] = false;
    });
    floor.style.backgroundPositionX = '0px';
    const bomb = document.querySelector('.bomb');
    const indicator = document.querySelector('.indicator');
    let hasbomb = false;
    localStorage.setItem('hasbomb', hasbomb);
    function gameLoop(){
        playerAngle += rotate;
        playerX += playerDx;
        playerY += playerDy;
        playerDx *= 0.8;
        playerDy -= 1;
                //console.log(playerDx);

        if (keys['ArrowUp'] || keys['w']) {
            if(hasbomb && indicator.classList.contains('on')){
                indicator.classList.remove('on');
                hasbomb = false;
                localStorage.setItem('hasbomb', hasbomb);
                player.removeChild(bomb);
                document.body.appendChild(bomb);
            }else{
                if(!isJumping){
                    if(playerDx>1)rotate=90/32;
                    if(playerDx>3)rotate=180/32;
                    if(playerDx<-1)rotate=-90/32;
                    if(playerDx<-3)rotate=-180/32;
                    isJumping = true;
                    playerDy = 15;
                }
            }
        }if(keys['ArrowLeft'] || keys['a']){
            if(isJumping && rotate==0)rotate=-90/(playerDy+17);
            playerDx = -playerSpeed;
        }if(keys['ArrowRight'] || keys['d']){
            if(isJumping && rotate==0)rotate=90/(playerDy+17);
            
            playerDx = playerSpeed;
        }
        
        if (playerX < 350) {
            //console.log(playerDx);
            floor.style.backgroundPositionX = `${(parseInt(floor.style.backgroundPositionX.split('px')[0])-playerDx)>1305?1305:(parseInt(floor.style.backgroundPositionX.split('px')[0])-playerDx)}px`;
            gameplay.style.left = floor.style.backgroundPositionX;
            
            playerX = 350;
        }else if (playerX > window.innerWidth - 350) {
            floor.style.backgroundPositionX = `${(parseInt(floor.style.backgroundPositionX.split('px')[0])-playerDx)<-1250?-1250:(parseInt(floor.style.backgroundPositionX.split('px')[0])-playerDx)}px`;
            gameplay.style.left = floor.style.backgroundPositionX;
            if(hasbomb==false){
                if(gameplay.querySelector('.bomb')){
                    if(parseInt(floor.style.backgroundPositionX.split('px')[0])<-650){
                        hasbomb=true;
                        localStorage.setItem('hasbomb',true);
                        gameplay.removeChild(bomb);
                        player.appendChild(bomb);
                    }
                }
            }
            
            playerX = window.innerWidth - 350; 
        }
        if(hasbomb==true){
            if(parseInt(floor.style.backgroundPositionX.split('px')[0])-playerX<-2200 && parseInt(floor.style.backgroundPositionX.split('px')[0])-playerX>-2350){
                indicator.classList.add('on');
            }else{
                indicator.classList.remove('on');
            }
        }
        if (playerY < 250) {
            rotate=0;
            isJumping = false;
            playerY = 250;
            playerDy = 0;
            playerAngle = Math.round(playerAngle / 90) * 90;

        }
        player.style.left = `${playerX}px`;
        player.style.bottom = `${playerY}px`;
        player.style.transform = `rotate(${playerAngle}deg)`;
        requestAnimationFrame(gameLoop);
    }

</script>
